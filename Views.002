AK155 12-03-2005 <Views.pas> Views.002

   Это о процедуре UpdateAll.
   Списки не сортированные и просматриваются каждый раз тупо от начала
до конца. При такой организации не нужно иметь два списка, достаточно
было бы обеспечить возможность вставки либо в начало (вместо
RegisterToBackground), либо в конец (вместо RegisterToPrior).
   Мне кажется очень странным, что логика выбора момента обновления
вынесена в глобальную процедуру UpdateAll. Я бы сделал на уровне TView
виртуальный метод AutoUpdate, в который бы и перенёс всю возню
с таймером. А в UpdateAll оставил просто безусловный вызов AutoUpdate
всех включённых в список объектов. Эффективность была бы точно такая,
понятность увеличилась бы (вся работа с таймером - внутри объекта),
а, главное, увеличилась бы гибкость, так как можно этот метод перекрыть
и реализовать какую-то другую логику.
    А если оставить вынесенную наружу работу с таймерами, то, конечно,
список должен быть сортированным по времени срабатывания таймера.
Тогда проверять надо только один первый элемент - остальные заведомо
не созрели. Заодно, если бы коллекция была сортированной и без повторений,
исчез бы подводный камень с повторным включением в список.



